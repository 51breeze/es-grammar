#!/usr/bin/env node  
const program = require('commander');
program
.version( 'EaseScript '+require('../package.json').version )
.option('-f, --file [file]', '指定需要编译的文件')
.option('-c, --config [file]', '指定配置文件',null)
.option('-o, --output [dir]', '输出路径','./build')
.option('-s, --syntax [javascript|php]', '要构建的语法',function (val) {
    return val.split(',');
})
.option('-S, --suffix [value]', '源文件的后缀名','.es')
.option('-w, --workspace [value]', '源文件目录', process.cwd() )
.option('-r, --reserved [keyword1,keyword2,...]', '指定需要保护的关键字', function (val) {
    return val.split(',');
})
.option('--env, --environment [dev|test|production]', '构建模式是用于生产环境还是测试环境','production')
program.parse(process.argv);
const Compiler = require('../lib/start.js');
const config = [
   "file",
   "config",
   "output",
   "syntax",
   "suffix",
   "reserved",
   "environment",
   "workspace"
];
const options = {};
config.forEach( name=>{
    if( program[name] ){
       options[name] = program[name];
    }
});
options.builder = options.syntax;
Compiler.start(options);
